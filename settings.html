<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SmarTab Settings</title>
    <link rel="stylesheet" href="styles/main.css" />
  </head>

  <body class="settings">
    <div class="settings-shell">
      <header class="settings-header">
        <button class="btn btn-ghost btn-icon" id="backButton" aria-label="Back">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
        <div class="settings-title">
          <img src="images/128.png" alt="SmarTab" />
          <div>
            <h1>Settings</h1>
            <p>Direct API access only. No proxy, no relay, just your provider.</p>
          </div>
        </div>
      </header>

      <!-- Main Settings View -->
      <div class="settings-view" id="mainSettings">
        <div class="settings-grid">
          <section class="card section" style="--delay: 0.05s">
            <h2>AI Provider</h2>
            <p class="section-desc">Pick your provider, model, and API key to power grouping.</p>
            <div class="field">
              <label for="aiProvider">Provider</label>
              <select id="aiProvider">
                <option value="gemini">Gemini</option>
                <option value="openai">OpenAI</option>
                <option value="custom">Custom (OpenAI-compatible)</option>
              </select>
            </div>
            <div class="field">
              <label for="apiKey">API Key</label>
              <div class="field-row">
                <input type="password" id="apiKey" placeholder="Paste your API key" />
                <button class="btn btn-secondary" type="button" id="testConnectionButton">
                  <span class="btn-spinner"></span>
                  <span class="btn-text">Test</span>
                </button>
              </div>
              <div id="connectionStatus" class="field-hint connection-status"></div>
            </div>
            <div class="field">
              <label for="modelName">Model</label>
              <div class="field-row">
                <select id="modelName" data-model-select></select>
                <input
                  type="text"
                  id="modelNameCustom"
                  class="hidden"
                  placeholder="e.g. openrouter/auto"
                />
              </div>
              <div id="modelHint" class="field-hint"></div>
            </div>
            <div class="field hidden" id="customApiBaseUrlField">
              <label for="customApiBaseUrl">API base URL</label>
              <input
                type="text"
                id="customApiBaseUrl"
                placeholder="https://openrouter.ai/api/v1"
              />
              <div class="field-hint">Provide the OpenAI-compatible base URL.</div>
            </div>
            <div class="security-note">Requests go directly to the provider you select.</div>
          </section>

          <section class="card section" style="--delay: 0.1s">
            <h2>Behavior</h2>
            <p class="section-desc">Control how SmarTab behaves when you browse.</p>
            <div class="toggle-row">
              <div class="toggle-text">
                <span>Auto-collapse other groups</span>
                <small>When you switch tabs, collapse other groups automatically.</small>
              </div>
              <label class="toggle">
                <input type="checkbox" id="closeOtherGroups" />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </section>

          <section class="card section" style="--delay: 0.15s">
            <h2>Advanced</h2>
            <p class="section-desc">Tab filters, custom instructions, and shortcuts.</p>
            <button class="btn btn-ghost advanced-link" id="openAdvancedSettings" type="button">
              <span>Advanced Settings</span>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" width="18" height="18">
                <path d="M9 6l6 6-6 6" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>
          </section>
        </div>
      </div>

      <!-- Advanced Settings View -->
      <div class="settings-view hidden" id="advancedSettings">
        <div class="settings-grid">
          <section class="card section" style="--delay: 0.05s">
            <button class="btn btn-ghost back-link" id="backToMain" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" width="18" height="18">
                <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              <span>Back to Settings</span>
            </button>
            <h2>Tab Filters</h2>
            <p class="section-desc">Control which tabs participate in grouping.</p>
            <div class="toggle-row">
              <div class="toggle-text">
                <span>Exclude pinned tabs</span>
                <small>Keep pinned tabs out of automatic grouping.</small>
              </div>
              <label class="toggle">
                <input type="checkbox" id="excludePinnedTabs" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="toggle-row">
              <div class="toggle-text">
                <span>Exclude already grouped tabs</span>
                <small>Don't regroup tabs that are already in groups.</small>
              </div>
              <label class="toggle">
                <input type="checkbox" id="excludeGroupedTabs" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="toggle-row">
              <div class="toggle-text">
                <span>Current window only</span>
                <small>Ignore tabs in other windows.</small>
              </div>
              <label class="toggle">
                <input type="checkbox" id="currentWindowOnly" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="toggle-row">
              <div class="toggle-text">
                <span>Exclude frozen tabs</span>
                <small>Skip discarded/suspended tabs.</small>
              </div>
              <label class="toggle">
                <input type="checkbox" id="excludeFrozenTabs" checked />
                <span class="toggle-slider"></span>
              </label>
            </div>
          </section>

          <section class="card section" style="--delay: 0.1s">
            <h2>Custom Instructions</h2>
            <p class="section-desc">Give AI additional context for better grouping.</p>
            <div class="field">
              <label for="customGroupingInstructions">Instructions (optional)</label>
              <textarea
                id="customGroupingInstructions"
                placeholder="Example: Always group GitHub tabs together. Separate work docs from tutorials."
              ></textarea>
            </div>
          </section>

          <section class="card section" style="--delay: 0.15s">
            <h2>Keyboard Shortcuts</h2>
            <p class="section-desc">Quick actions from anywhere in Chrome.</p>
            <div class="shortcut-row">
              <div class="shortcut-info">
                <span class="shortcut-name">Group all tabs</span>
                <span class="shortcut-desc">Trigger AI grouping</span>
              </div>
              <kbd id="groupShortcut">Ctrl+Shift+G</kbd>
            </div>
            <div class="shortcut-row">
              <div class="shortcut-info">
                <span class="shortcut-name">Search tabs</span>
                <span class="shortcut-desc">Open tab search overlay</span>
              </div>
              <kbd id="searchShortcut">Ctrl+Shift+F</kbd>
            </div>
            <p class="field-hint" style="margin-top: 12px;">
              <button class="btn btn-ghost btn-sm" id="openShortcutsLink" type="button">
                Customize shortcuts in Chrome settings â†’
              </button>
            </p>
          </section>
        </div>
      </div>
    </div>

    <script src="settings.js"></script>
  </body>
</html>
